# Processor

## Description

That is an emulation of some functions of a specific processor. It has a stack and four registers of double-precision floating-point numbers.
It also has a call stack (see commands call and ret below).

Here is a specific assembler language for this processor:

| Registers|
|----------|
| rax      |
| rbx      |
| rcx      |
| rdx      |

| Commands | Meaning |
|----------|---------|
| halt     | end of program  |
| in       | read number from stdin and put on stack |
| out      | take number from stack and write it to stdout |
| add      | take two numbers from stack, sum them and put result on stack |
| sub      | take two numbers from stack, subtract the first taken from the second and put result in stack |
| mul      | take two numbers from stack, multiply them and put result on stack |
| div      | take two numbers from stack, divide the second taken by the first and put result on stack |
| sqrt     | take number from stack and put on stack its square root |
| pop      | take number from stack and put it in specified register, if register is not specified just removes number from stack |
| push     | put on stack a number stored in specified register or specified number |
| jmp      | jump to the specified label and continue execution from the code just after the definition of the label |
| jif      | take number from stack and if it is true, jumps to the specified label and continue execution from the code just after the definition of the label |
| call     | this command puts the place of itself on call stack, jumps to the specified label and the execution continuing from the code just after the definition of the label |
| ret      | take last record from call stack and continue execution just after the call, that made this record |
| less     | take two numbers from stack, and if the first less then the second, put true on stack, else put false |
| grtr     | take two numbers from stack, and if the first greater then the second, put true on stack, else put false |
| or       | take two numbers from stack, if at least one of them true, put true on stack, else put false |
| and      | take two numbers from stack, if both of them true, put true on stack, else put false |
| not      | take number from stack, if it is false, put true on stack, else put false |

The command pop could be followed by the name of some register.
The command push must be followed by either the name of some register or a double-precision floating-point number.
The command jmp must be followed by the name of the label, that is defined in code. To define a label type its
name (the sequence of alpha and digit symbols), then colon (:) without space symbols between them.
True and false are represented as 1 and -1 one. If operations jif, or, and, not are being applied to other values, behavior is undefined.

File with code should have halt command. It should be the last command in the file, because other text after this command is not taken into account.
That is a design flaw, which is not fixed yet.

You can see an example of code in specific assembler language in test1.kasm file. This code reads coefficients of quadratic equation and calculates
a square root of its discriminant.

The other example is in test6.kasm file. This program reads a number and prints corresponding Fibonacci number. If the read number is incorrect (not natural),
prints some value (you can try to understand what is it).

In this project assembler, disassembler and processor for this specific assembler language are realized. Assembler assembles a specific
binary code from program in specific assembler language. Disassembler disassembles specific binary code back to specific assembler language.
Processor processes program in specific binary code.

## Getting Started

### Dependencies

* Windows

* MinGW

### Installing

* download directories hw03_unkillable_stack and hw04_processor from https://github.com/Green-Chan/ISP_RAS_programming_course .
  They should stay the sibling directories (have the same parent directory).

### Building

* Open CMD

* Get to the hw04_processor directory
```
> cd path\to\the\directory\hw04_processor
```
> **Note:** If you need to change the drive from C: to D:, type "D:" (without quotes).

* Run mingw32-make
```
> mingw32-make
```
> **Note:** you may need to learn how to add MinGW\bin to the PATH (the Environment Settings section in http://www.mingw.org/wiki/Getting_Started/).

### Running tests

* Run mingw32-make with argument test
```
> mingw32-make test
```
> **Note:** mingw32-make test execute run_tests.exe redirecting input

## Debugging

To debug the program using GDB:
* Rebuild the program with DEBUG=1
```
> mingw32-make clean
> mingw32-make DEBUG=1
```
* Run program using GDB
```
> gdb run_tests.exe
```

## Documentation

You can find documentation, generated by Doxygen in hw04_processor\documentation directory. If you have Doxygen and know how to use it, you can generate documentation yourself using Doxyfile in the same directory hw04_processor\documentation).

## Authors

Litskevich Karina

Contact me on telegram: [@karkarik](https://t.me/karkarik)
